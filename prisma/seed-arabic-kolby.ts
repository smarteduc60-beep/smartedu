import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('๐ฑ ุจุฏุก ุงุณุชูุฑุงุฏ ุฏุฑุณ ุงูููุงูุจู (ุงูุนูู ูุงูุงุณุชุจุฏุงุฏ)...');

  // 1. ุงูุจุญุซ ุนู ุงููุนูู ูุงููุงุฏุฉ ูุงููุณุชูู
  const teacher = await prisma.user.findFirst({
    where: { role: { name: 'teacher' } },
  });

  const subject = await prisma.subject.findFirst({
    where: { name: { contains: 'ุงููุบุฉ ุงูุนุฑุจูุฉ' } },
  });

  const level = await prisma.level.findFirst({
    where: { name: { contains: 'ุฑุงุจุนุฉ ูุชูุณุท' } },
  });

  if (!teacher || !subject || !level) {
    console.error('โ ุฎุทุฃ: ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุนููุ ุฃู ูุงุฏุฉ ุงููุบุฉ ุงูุนุฑุจูุฉุ ุฃู ูุณุชูู ุงูุฑุงุจุนุฉ ูุชูุณุท.');
    return;
  }

  console.log(`โ ุชู ุงูุนุซูุฑ ุนูู: ุงููุนูู (${teacher.firstName})ุ ุงููุงุฏุฉ (${subject.name})ุ ุงููุณุชูู (${level.name})`);

  // 2. ุชุฌููุฒ ูุญุชูู ุงูุฏุฑุณ (HTML)
  const lessonContent = `
    <h1>ุงูุนูู ููุฑ ูุชุจุฏุฏ ุจู ุธูุงู ุงูุงุณุชุจุฏุงุฏ: ุฑุคูุฉ ุงูููุงูุจู ุงูุชุญููููุฉ</h1>
    <p class="lead">ุงูุชุดู ููู ููุดู ุนุจุฏ ุงูุฑุญูู ุงูููุงูุจู ุงูุนูุงูุฉ ุงูุฌุฏููุฉ ุจูู ุงูุฌูู ูุงูุณูุทุฉ ุงููุณุชุจุฏุฉุ ูููู ููุนุฏ ุงูุนูู ุงูููุชุงุญ ููุชุญุฑุฑ ูุงูููุถุฉ.</p>

    <hr>

    <h2>1. ุฃุจุฑุฒ ุงูููุงุท ุงูุฌููุฑูุฉ</h2>
    <ul>
      <li><strong>ุงููุณุชุจุฏ ูุงููุตู ุงูุฎุงุฆู:</strong> ูุดุจูู ุงูููุงูุจู ุงููุณุชุจุฏ ุจุงููุตู ุงูุฎุงุฆู ุงูุฐู ูุณุนู ูุฅุจูุงุก ุงูุฑุนูุฉ ูู ุฌูู ูุถุนู ูุถูุงู ุงุณุชูุฑุงุฑ ุณูุทุฑุชู ุนูู ูุตุงุฆุฑูู ูุซุฑูุงุชูู.</li>
      <li><strong>ุงูุฌูู ุฃุณุงุณ ุงูุงุณุชุนุจุงุฏ:</strong> ูุคูุฏ ุงููุต ุฃู ุงูุงุณุชุนุจุงุฏ ูุงูุธูู ูุง ูููู ุฃู ูุณุชูุฑุง ุฅูุง ูู ุธู ุฌูู ุงูุฑุนูุฉ ูุชูููุง.</li>
      <li><strong>ุงูุนูู ููุฑ ุฅููู ูุชุญุฑุฑ:</strong> ููุฏู ุงูููุงูุจู ุงูุนูู ุนูู ุฃูู "ูุจุณุฉ ูู ููุฑ ุงููู" ุชุถูุก ุงูุนููู ูุชุญุฑุฑ ุงููููุณ.</li>
    </ul>

    <h2>2. ุงููุต ุงููุญูุฑู: ุตุฑุงุน ุงูุนูู ูุงูุงุณุชุจุฏุงุฏ</h2>
    <p>ูู ููุงูุชู ุงูุซุงูุจุฉ ูู ูุชุงุจู "ุทุจุงุฆุน ุงูุงุณุชุจุฏุงุฏ ููุตุงุฑุน ุงูุงุณุชุนุจุงุฏ"ุ ูุทุฑุญ ุงููููุฑ ุงูุนุฑุจู ุนุจุฏ ุงูุฑุญูู ุงูููุงูุจู ุฑุคูุฉ ุนูููุฉ ุญูู ุงูุนูุงูุฉ ุจูู ุงูุณูุทุฉ ุงููุณุชุจุฏุฉ ููููุฉ ุงูุนูู ูุงููุนุฑูุฉ:</p>
    <blockquote class="border-r-4 border-primary pr-4 my-4 italic bg-muted/30 p-4 rounded">
      <p>ูุง ุฃุดุจู ุงููุณุชุจุฏูู ูู ูุณุจุชู ุฅูู ุฑุนูุชู ุจุงููุตูู ุงูุฎุงุฆู ุงููููุ ูุชุตุฑูู ูู ุฃููุงู ุงูุฃูุชุงู ูุฃููุณูู ููุง ูููู ูุง ุฏุงููุง ุถุนุงูุงู ูุงุตุฑููุ ูููุง ุฃููู ููุณ ูู ุตุงูุญ ุงููุตูู ุฃู ูุจูุบ ุงูุฃูุชุงู ุฑุดุฏููุ ูุฐูู ููุณ ูู ุบุฑุถ ุงููุณุชุจุฏู ุฃู ุชุชูููุฑ ุงูุฑุนูุฉ ุจุงูุนูู. ูุง ูุฎูู ุนูู ุงููุณุชุจุฏูุ ูููุง ูุงู ุบุจูุงูุ ุฃูู ูุง ุงุณุชุนุจุงุฏ ููุง ุงุนุชุณุงู ุฅูุง ูุงุฏุงูุช ุงูุฑูุนูุฉ ุญููุงุก ุชุฎุจุท ูู ุธูุงูุฉ ุฌูู ูุชูู ุนูุงุกุ ููู ูุงู ุงููุณุชุจุฏูู ุทูุฑุงู ููุงู ุฎููุงุดุงู ูุตุทุงุฏ ููุงู ุงูุนูุงู ูู ุธูุงู ุงูุฌููุ ููู ูุงู ูุญุดุงู ููุงู ุงุจู ุขูู ูุชูููู ุฏูุงุฌู ุงูุญูุงุถุฑ ูู ุบุดุงุก ุงููููุ ูููููู ูู ุงูุฅูุณุงู ูุตูุฏ ุนุงููููู ุฌุงููููู.</p>
      <br>
      <p>ุงูุนูู ูุจุณุฉู ูู ููุฑ ุงููู...</p>
    </blockquote>

    <h2>3. ูุธุฑุฉ ูุนููุฉ: ุงูุนูุงูุฉ ุงูุฌุฏููุฉ ุจูู ุงูุนูู ูุงูุงุณุชุจุฏุงุฏ</h2>
    <p>ููุนุงูุฌ ุงูููุงูุจู ูู ูุฐุง ุงููุต ุงูุนูุงูุฉ ุงููุชูุชุฑุฉ ูุงููุนูุฏุฉ ุจูู ุงูุงุณุชุจุฏุงุฏ ูุงูุนูู. ูุฑู ุฃู ุงููุณุชุจุฏุ ุจุทุจูุนุชูุ ูุณุนู ููุญูุงุธ ุนูู ุฌูู ุฑุนูุชู ูุถูุงู ุงุณุชูุฑุงุฑ ุณูุทุฑุชู.</p>
    
    <h3>ุงููุณุชุจุฏ: ูุตู ุฎุงุฆู ูุญููุงู ููุชุฑุณ</h3>
    <p><strong>ุชุดุจูู ุงููุตู ุงูุฎุงุฆู:</strong> ุงูููุงุฑูุฉ ุจูู ุงููุณุชุจุฏ ูุงููุตู ุงูุฎุงุฆู ููุฃูุชุงู ูู ุชุดุจูู ุจููุบ ููุนุงู. ููุง ุฃู ุงููุตู ูุง ูุฑุบุจ ูู ุฃู ูุจูุบ ุงูุฃูุชุงู ุฑุดุฏูู ุญุชู ูุง ูููุฏ ุณูุทุฑุชู ุนูู ุฃููุงูููุ ููุฐูู ุงููุณุชุจุฏ ูุง ูุฑูุฏ ูุฑุนูุชู ุฃู ุชุชููุฑ ุจุงูุนูู.</p>
    <p><strong>ุตูุฑ ุงูุฎูุงุด ูุงุจู ุขูู:</strong> ูุชุนุฒูุฒ ุตูุฑุฉ ุงููุณุชุจุฏ ุงููุชุฎูู ูู ุงูุธูุงู ูุงูุฌููุ ูุณุชุฎุฏู ุงูููุงูุจู ุชุดุจููุงุช ุญููุงููุฉ ูููุฉ. ูุตู ุงููุณุชุจุฏ ุจุฃูู "ูู ูุงู ุทูุฑุงู ููุงู ุฎููุงุดุงู ูุตุทุงุฏ ููุงู ุงูุนูุงู ูู ุธูุงู ุงูุฌูู".</p>

    <h3>ุงูุนูู: ูุจุณุฉ ูู ููุฑ ุงููู ูุทุฑูู ุงูุชุญุฑุฑ</h3>
    <p>ูู ุงูููุงุจูุ ูุตู ุงูููุงูุจู ุงูุนูู ุจุฃูู "ูุจุณุฉ ูู ููุฑ ุงููู". ูุฐู ุงูุนุจุงุฑุฉ ุงูุจููุบุฉ ูุง ุชุตู ุงูุนูู ููุฌุฑุฏ ูุฌููุนุฉ ูู ุงูุญูุงุฆูุ ุจู ูููุฉ ุฑูุญูุฉ ููุนูููุฉ ูุงุฏุฑุฉ ุนูู ุชุจุฏูุฏ ุงูุธูุงู.</p>
  `;

  // 3. ุฅูุดุงุก ุงูุฏุฑุณ
  const lesson = await prisma.lesson.create({
    data: {
      title: 'ุงูุนูู ููุฑ ูุชุจุฏุฏ ุจู ุธูุงู ุงูุงุณุชุจุฏุงุฏ: ุฑุคูุฉ ุงูููุงูุจู ุงูุชุญููููุฉ',
      content: lessonContent,
      subjectId: subject.id,
      levelId: level.id,
      authorId: teacher.id,
      type: 'public',
      status: 'approved',
      imageUrl: 'https://storage.googleapis.com/e-object-409003.firebasestorage.app/llm-nwr-lthrr-lkwkby-r3255o3ka5.jpg', // ุตูุฑุฉ ุงูููุงูุจู
    },
  });

  console.log(`โ ุชู ุฅูุดุงุก ุงูุฏุฑุณ: "${lesson.title}" (ID: ${lesson.id})`);

  // 4. ุฅุถุงูุฉ ุชูุงุฑูู ุชุญููููุฉ ุจูุงุกู ุนูู ุฃูุฏุงู ุงูุฏุฑุณ
  console.log('๐ ุฌุงุฑู ุฅุถุงูุฉ ุชูุงุฑูู ุชุญููููุฉ...');

  const exercisesData = [
    {
      question: 'ูุง ูู ุงูุชุดุจูู ุงูุฑุฆูุณู ุงูุฐู ูุณุชุฎุฏูู ุงูููุงูุจู ููุตู ุนูุงูุฉ ุงููุณุชุจุฏ ุจุฑุนูุชู ูู ุงูููุฑุฉ ุงูุฃูููุ',
      modelAnswer: 'ุดุจู ุงูููุงูุจู ุงููุณุชุจุฏ ุจุงููุตู ุงูุฎุงุฆู ุงูููู ุงูุฐู ูุชุตุฑู ูู ุฃููุงู ุงูุฃูุชุงู ูุฃููุณูู ููุง ูููู ูุง ุฏุงููุง ุถุนุงูุงู ูุงุตุฑูู.',
      maxScore: 2,
    },
    {
      question: 'ุจู ุดุจู ุงูููุงูุจู ุงููุณุชุจุฏ ูู ูุงู ุทูุฑุงูุ ูููุงุฐุงุ',
      modelAnswer: 'ุดุจูู ุจุงูุฎูุงุด ุงูุฐู ูุตุทุงุฏ ููุงู ุงูุนูุงู ูู ุธูุงู ุงูุฌูู. ุงูุณุจุจ: ูุฃู ุงููุณุชุจุฏ ูุฒุฏูุฑ ูู ุบูุงุจ ุงูููุฑ (ุงููุนู) ููุณุชุบู ุถุนู ูุฌูู ุงูุนุงูุฉ.',
      maxScore: 3,
    },
    {
      question: 'ูุง ูู ุงูุนุจุงุฑุฉ ุงูุชู ุชุตู ุงูุนูู ูู ุงููุตุ ููุง ุฏูุงูุชูุงุ',
      modelAnswer: 'ุงูุนุจุงุฑุฉ ูู "ุงูุนูู ูุจุณุฉ ูู ููุฑ ุงููู". ุฏูุงูุชูุง: ุฃู ุงูุนูู ููุณ ูุฌุฑุฏ ูุนุฑูุฉ ุญุณูุฉุ ุจู ูู ููุฉ ุฑูุญูุฉ ูููุฑูุฉ ุชุถูุก ุงูุนููู ูุชูุฏู ุฅูู ุงูุตูุงุญ ูุงูุญุฑูุฉ.',
      maxScore: 3,
    },
    {
      question: 'ููุงุฐุง ูุฎุดู ุงููุณุชุจุฏ ูู ุชูููุฑ ุงูุฑุนูุฉ ุจุงูุนููุ',
      modelAnswer: 'ูุฃู ุงูุฌูู ูู ุฃุณุงุณ ุงุณุชุนุจุงุฏูู ูุงุนุชุณุงููู. ูุงูุนูู ูููุธ ุงููููุณ ููุฒุฑุน ูููุง ุนุฒุฉ ุงูููุณ ูุงูุดูุงูุฉุ ููุง ูุฌุนู ุงูุฑุนูุฉ ุชุฏุฑู ุญููููุง ูุชุทุงูุจ ุจูุง.',
      maxScore: 2,
    },
    {
      question: 'ุงุณุชุฎุฑุฌ ูู ุงููุต ูุซุงูุงู ุนูู ุงูุชุถุงุฏ ูุจูู ุฃุซุฑู ูู ุงููุนูู.',
      modelAnswer: 'ุงููุซุงู: ุงูุธูุงู ูุงูููุฑ (ุฃู ุงูุฌูู ูุงูุนูู). ุงูุฃุซุฑ: ุฅุจุฑุงุฒ ุงูุชูุงูุถุงุช ูุชุฃููุฏ ุงูููุฑุฉ ุงูุฑุฆูุณูุฉ ูุตุฑุงุน ุงูุฎูุฑ ูุงูุดุฑุ ุฃู ุงูุชูููุฑ ูุงูุฌูู.',
      maxScore: 2,
    },
    {
      question: 'ูุง ูุนูู ูููุฉ "ุงูุงุนุชุณุงู" ูู ุณูุงู ุงููุตุ',
      modelAnswer: 'ุงูุงุนุชุณุงู ูุนูู ุงูุธูู ูุงูููุฑ ูุงุณุชุฎุฏุงู ุงูููุฉ ุจุบูุฑ ุญู.',
      maxScore: 1,
    }
  ];

  for (const [index, ex] of exercisesData.entries()) {
    await prisma.exercise.create({
      data: {
        lessonId: lesson.id,
        type: 'main',
        questionRichContent: `<p>${ex.question}</p>`,
        question: ex.question,
        modelAnswer: `<p>${ex.modelAnswer}</p>`,
        maxScore: ex.maxScore,
        displayOrder: index + 1,
        allowRetry: true,
        maxAttempts: 3,
      },
    });
  }

  console.log(`โ ุชู ุฅุถุงูุฉ ${exercisesData.length} ุชูุฑูู ููุฏุฑุณ.`);
  console.log('๐ ุงูุชููุช ุงูุนูููุฉ ุจูุฌุงุญ!');
}

main()
  .catch((e) => {
    console.error('โ ุญุฏุซ ุฎุทุฃ:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
