--- /dev/null
+++ plan.md
@@ -0,0 +1,48 @@
+# خطة تنفيذ ميزة "حفظ مسودة" (Save Draft)
+
+## 1. تحليل الأثر (Impact Analysis)
+- **الهدف:** تمكين المعلمين والمشرفين من حفظ الدروس دون نشرها للطلاب.
+- **المخاطر:** يجب التأكد من أن الدروس المحفوظة كمسودة لا تظهر في واجهة الطالب (Student Portal) أو واجهة ولي الأمر.
+- **التغييرات المطلوبة:** تشمل قاعدة البيانات (بشكل طفيف)، الواجهة الخلفية (API)، والواجهة الأمامية (UI).
+
+## 2. التغييرات المقترحة
+
+### أ. قاعدة البيانات (Database & Schema)
+- **الوضع الحالي:** جدول `Lesson` يحتوي على حقل `status` من نوع `String` بقيمة افتراضية `pending` (أو `approved` في الكود الحالي).
+- **التعديل:** لا نحتاج لتغيير هيكلية قاعدة البيانات (Schema Migration)، سنقوم فقط باعتماد قيمة قياسية جديدة للحقل `status` وهي: `'draft'`.
+
+### ب. الواجهة الخلفية (Backend API)
+1.  **تعديل `POST /api/lessons`:**
+    - استقبال حقل `status` من جسم الطلب (Request Body).
+    - إذا كانت القيمة `draft`، يتم الحفظ بهذه الحالة.
+    - إذا لم ترسل، يتم الاعتماد على المنطق الحالي (`approved` للمعلم).
+    - **التحقق (Validation):** قد نحتاج لتخفيف قيود التحقق للمسودات (مثلاً: السماح بحفظ مسودة بعنوان فقط دون محتوى كامل، أو الإبقاء على القيود الحالية لضمان جودة البيانات). *سنبقي القيود الحالية مبدئياً للتبسيط.*
+
+2.  **تعديل `PUT /api/lessons/[id]`:**
+    - السماح بتحديث حالة الدرس من `draft` إلى `approved` (نشر) والعكس.
+
+3.  **تعديل `GET /api/lessons`:**
+    - **للطلاب:** التأكد من أن استعلام `Prisma` يضيف شرط `status: 'approved'` أو `type: 'public'` (حسب المنطق المعتمد) لاستبعاد المسودات.
+    - **للمعلمين:** يجب أن يرى المعلم جميع دروسه (المسودات والمنشورة).
+
+### ج. الواجهة الأمامية (Frontend UI)
+1.  **صفحة إنشاء/تعديل الدرس (`create-lesson-client.tsx` & `edit-lesson-client.tsx`):**
+    - إضافة زر جديد بجانب زر "حفظ الدرس" بمسمى "حفظ كمسودة" (Save as Draft).
+    - الزر الحالي يتغير مسماه إلى "نشر الدرس" (Publish Lesson).
+    - عند الضغط على "حفظ كمسودة"، يتم إرسال `status: 'draft'` للـ API.
+    - عند الضغط على "نشر"، يتم إرسال `status: 'approved'`.
+
+2.  **قائمة الدروس (`lessons/page.tsx`):**
+    - إضافة `Badge` بجانب عنوان الدرس توضح حالته (مسودة / منشور).
+    - تمييز المسودات بلون مختلف (مثلاً رمادي أو أصفر).
+
+## 3. خطوات التنفيذ (Execution Steps)
+
+1.  [ ] **Backend:** تحديث `POST` و `PUT` في `api/lessons` لدعم حقل `status`.
+2.  [ ] **Backend:** مراجعة `GET /api/lessons` للتأكد من عزل المسودات عن الطلاب.
+3.  [ ] **Frontend:** تحديث مكونات إنشاء وتعديل الدروس لإضافة الزر ومنطق الإرسال.
+4.  [ ] **Frontend:** تحديث عرض قائمة الدروس لإظهار حالة الدرس.
+5.  [ ] **Testing:** اختبار دورة حياة الدرس (إنشاء مسودة -> تعديل -> نشر -> إخفاء).
+
+## 4. ملاحظات هامة
+- يجب التأكد من أن المسودات لا تظهر في نتائج البحث العامة.
+- يجب التأكد من أن الإشعارات (Notifications) لا تُرسل للطلاب عند حفظ مسودة، بل فقط عند النشر.
+- يجب مراجعة صلاحيات المستخدمين لضمان أن فقط المعلمين والمشرفين يمكنهم حفظ الدروس كمسودات.